<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GeneSeq Vista - 유전자 분석 보고서</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>
    <style>
        /* ========================================
           CSS Custom Properties
        ======================================== */
        :root {
            /* Primary Colors */
            --primary-red: #DC2626;
            --primary-red-light: #FEF2F2;
            --primary-red-dark: #991B1B;
            --primary-grey-light: #f1f1f1;
            
            /* Neutral Colors */
            --white: #FFFFFF;
            --black: #000000;
            --gray-50: #F9FAFB;
            --gray-100: #F3F4F6;
            --gray-200: #E5E7EB;
            --gray-300: #D1D5DB;
            --gray-400: #9CA3AF;
            --gray-500: #6B7280;
            --gray-600: #4B5563;
            --gray-700: #374151;
            --gray-800: #1F2937;
            --gray-900: #111827;
            
            /* Typography */
            --font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            --font-size-xs: 11px;
            --font-size-sm: 13px;
            --font-size-base: 14px;
            --font-size-md: 15px;
            --font-size-lg: 18px;
            
            /* Spacing */
            --spacing-xs: 8px;
            --spacing-sm: 12px;
            --spacing-md: 16px;
            --spacing-lg: 20px;
            --spacing-xl: 24px;
            --spacing-2xl: 40px;
            
            /* Border Radius */
            --radius-sm: 4px;
            --radius-md: 6px;
            --radius-lg: 8px;
            --radius-xl: 12px;
            
            /* Shadows */
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 2px 10px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 4px 20px rgba(0, 0, 0, 0.12);
        }

        /* ========================================
           Reset & Base Styles
        ======================================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-family);
            background: var(--gray-50);
            line-height: 1.6;
            color: var(--gray-800);
            min-height: 100vh;
        }

        /* ========================================
           Header Component
        ======================================== */
        .app-header {
            background: var(--white);
            border-bottom: 1px solid var(--gray-200);
        }

        .header-container {
            background: var(--white);
            border: 1px solid var(--gray-200);
            overflow: hidden;
        }

        .header-title {
            background: var(--primary-red);
            color: var(--white);
            padding: var(--spacing-sm) var(--spacing-lg);
            text-align: center;
            font-size: var(--font-size-lg);
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .header-subtitle {
            background: var(--gray-100);
            padding: 10px var(--spacing-lg);
            font-size: var(--font-size-sm);
            color: var(--gray-600);
            border-bottom: 1px solid var(--gray-200);
            line-height: 1.5;
        }

        /* ========================================
           Analysis Summary Component
        ======================================== */
        .analysis-summary {
            border-bottom: 2px solid var(--gray-300);
        }

        .summary-section {
            border-bottom: 1px solid var(--gray-200);
        }

        .section-header {
            padding: var(--spacing-sm) var(--spacing-lg);
            font-size: var(--font-size-base);
            font-weight: 600;
            color: var(--gray-800);
            border-bottom: 1px solid var(--gray-200);
            background: var(--primary-grey-light);
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
        }

        .section-header::before {
            content: "◆";
            color: var(--primary-red);
            font-size: 12px;
        }

        /* Data Table Component */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: var(--font-size-sm);
            background: var(--white);
        }

        .data-table__header {
            background: var(--gray-50);
            font-weight: 600;
            color: var(--gray-800);
            letter-spacing: 0.5px;
            font-size: var(--font-size-xs);
        }

        .data-table__cell {
            border: 1px solid var(--gray-200);
            padding: var(--spacing-xs) var(--spacing-sm);
            text-align: center;
            transition: background-color 0.2s ease;
        }

        .data-table__row:nth-child(even) {
            background: var(--gray-50);
        }

        .data-table__row:hover {
            background: var(--primary-red-light);
        }

        .table-note {
            padding: var(--spacing-xs) var(--spacing-lg);
            font-size: var(--font-size-xs);
            color: var(--gray-500);
            text-align: right;
            background: var(--gray-50);
        }

        .table-note-content {
            display: inline-block;
            text-align: left;
            max-width: 300px;
            line-height: 1.4;
        }

        /* ========================================
           Pathogen Selection Component
        ======================================== */
        .pathogen-selector {
            display: flex;
            min-height: 200px;
        }

        .selector-form {
            border-right: 1px solid var(--gray-200);
            min-width: 400px;
            background: var(--white);
        }

        .form-field {
            display: flex;
            border-bottom: 1px solid var(--gray-200);
        }

        .form-field__label {
            background: var(--gray-50);
            padding: var(--spacing-sm) var(--spacing-lg);
            font-weight: 600;
            min-width: 150px;
            border-right: 1px solid var(--gray-200);
            font-size: var(--font-size-base);
            color: var(--gray-700);
            display: flex;
            align-items: center;
        }

        .form-field__input {
            padding: var(--spacing-sm) var(--spacing-lg);
            flex: 1;
            font-size: var(--font-size-base);
            display: flex;
            align-items: center;
            background: var(--white);
        }

        .pathogen-select {
            width: 200px;
            padding: var(--spacing-xs) var(--spacing-sm);
            border: 1px solid var(--gray-300);
            border-radius: var(--radius-sm);
            font-size: var(--font-size-base);
            color: var(--primary-red);
            background: var(--white);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .pathogen-select:focus {
            outline: none;
            border-color: var(--primary-red);
            box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1);
        }

        .pathogen-select:disabled {
            background-color: var(--gray-100);
            color: var(--gray-400);
            cursor: not-allowed;
            opacity: 0.6;
        }

        .pathogen-select option {
            color: var(--gray-800);
        }

        .field-value--highlight {
            color: var(--primary-red);
            font-weight: 500;
        }

        /* Info Panel Component */
        .info-panel {
            padding: var(--spacing-lg);
            background: var(--gray-50);
            width: 300px;
            border-left: 1px solid var(--gray-200);
        }

        .info-item {
            font-size: var(--font-size-sm);
            margin: var(--spacing-xs) 0;
            display: flex;
            gap: var(--spacing-xs);
            line-height: 1.5;
        }

        .info-item__label {
            font-weight: 600;
            color: var(--gray-700);
            min-width: 100px;
            flex-shrink: 0;
        }

        .info-item__value {
            color: var(--gray-800);
            word-break: break-word;
        }

        /* ========================================
           Main Content Area
        ======================================== */
        .main-content {
            width: 100%;
            padding: var(--spacing-lg);
        }

        .content-container {
            background: var(--white);
            padding: var(--spacing-2xl);
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-lg);
            min-height: calc(100vh - 400px);
        }

        /* ========================================
           Markdown Content Styles
        ======================================== */
        .markdown-content {
            max-width: 100%;
            font-size: var(--font-size-md);
            line-height: 1.7;
            color: var(--gray-800);
        }

        .markdown-content h1 {
            color: var(--gray-900);
            border-bottom: 3px solid var(--primary-red);
            padding-bottom: var(--spacing-sm);
            margin-bottom: var(--spacing-xl);
            font-size: 1.75rem;
            font-weight: 700;
        }

        .markdown-content h2 {
            color: var(--gray-800);
            border-bottom: 2px solid var(--gray-200);
            padding-bottom: var(--spacing-xs);
            margin-top: var(--spacing-2xl);
            margin-bottom: var(--spacing-lg);
            font-size: 1.375rem;
            font-weight: 600;
        }

        .markdown-content h3 {
            color: var(--gray-700);
            margin-top: 30px;
            margin-bottom: var(--spacing-md);
            font-size: 1.125rem;
            font-weight: 600;
        }

        .markdown-content table {
            width: 100%;
            border-collapse: collapse;
            margin: var(--spacing-xl) 0;
            font-size: var(--font-size-base);
            background: var(--white);
            overflow: hidden;
        }

        .markdown-content th,
        .markdown-content td {
            border: 1px solid var(--gray-200);
            padding: 14px var(--spacing-sm);
            text-align: left;
        }

        .markdown-content th {
            background: var(--gray-50);
            font-weight: 600;
            color: var(--gray-800);
            font-size: var(--font-size-sm);
            letter-spacing: 0.5px;
        }

        .markdown-content tr:nth-child(even) {
            background: var(--gray-50);
        }

        .markdown-content tr:hover {
            background: var(--primary-red-light);
        }

        .markdown-content code {
            background: var(--gray-100);
            padding: 3px var(--spacing-xs);
            border-radius: var(--radius-sm);
            font-family: 'Monaco', 'Consolas', 'SF Mono', monospace;
            font-size: 0.875em;
            color: var(--gray-800);
        }

        .markdown-content blockquote {
            border-left: 4px solid var(--primary-red);
            margin: var(--spacing-xl) 0;
            padding: var(--spacing-md) var(--spacing-xl);
            background: var(--primary-red-light);
            font-style: italic;
        }

        .markdown-content strong {
            color: var(--gray-900);
            font-weight: 600;
        }

        .markdown-content a {
            color: var(--primary-red);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .markdown-content a:hover {
            color: var(--primary-red-dark);
            text-decoration: underline;
        }

        .markdown-content hr {
            border: none;
            height: 2px;
            background: linear-gradient(to right, transparent, var(--primary-red), transparent);
            margin: var(--spacing-2xl) 0;
        }

        .markdown-content ul,
        .markdown-content ol {
            margin: var(--spacing-md) 0;
            padding-left: var(--spacing-xl);
        }

        .markdown-content li {
            margin: var(--spacing-xs) 0;
            line-height: 1.6;
        }

        .markdown-content p {
            margin: var(--spacing-md) 0;
            line-height: 1.7;
        }

        /* ========================================
           Responsive Table Wrapper
        ======================================== */
        .table-wrapper {
            overflow-x: auto;
            margin: 0;
        }

        /* ========================================
           Loading State
        ======================================== */
        .loading-state {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: var(--spacing-2xl);
            color: var(--gray-500);
            font-size: var(--font-size-base);
        }

        .loading-spinner {
            width: 20px;
            height: 20px;
            border: 2px solid var(--gray-300);
            border-top: 2px solid var(--primary-red);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ========================================
           Responsive Design
        ======================================== */
        @media (max-width: 1200px) {
            .pathogen-selector {
                flex-direction: column;
            }
            
            .info-panel {
                width: 100%;
                border-left: none;
                border-top: 1px solid var(--gray-200);
            }
            
            .selector-form {
                min-width: auto;
                border-right: none;
            }
        }

        @media (max-width: 768px) {
            .main-content {
                padding: var(--spacing-sm);
            }
            
            .content-container {
                padding: var(--spacing-lg);
            }
            
            .pathogen-selector {
                flex-direction: column;
            }
            
            .info-panel {
                width: 100%;
                padding: var(--spacing-md);
                border-left: none;
                border-top: 1px solid var(--gray-200);
            }
            
            .selector-form {
                min-width: auto;
                border-right: none;
            }
            
            .form-field {
                flex-direction: column;
            }
            
            .form-field__label {
                width: 100%;
                border-right: none;
                border-bottom: 1px solid var(--gray-200);
            }
            
            .data-table {
                font-size: var(--font-size-xs);
            }
            
            .data-table__cell {
                padding: 10px var(--spacing-xs);
            }
            
            .markdown-content h1 {
                font-size: 1.5rem;
            }
            
            .markdown-content h2 {
                font-size: 1.25rem;
            }
            
            .markdown-content h3 {
                font-size: 1.125rem;
            }
        }

        /* ========================================
           Utility Classes
        ======================================== */
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .font-bold { font-weight: 600; }
        .text-primary { color: var(--primary-red); }
        .text-muted { color: var(--gray-500); }
        .bg-highlight { background: var(--primary-red-light); }
    </style>
</head>
<body>
    <!-- Application Header -->
    <header class="app-header">
        <div class="header-container">
            <div class="header-title">
                GeneSeq Vista AI Agent
            </div>
            
            <div class="header-subtitle">
                PCR 검출용으로 AI기반 문헌탐색과 서열분석 결과로 최적의 target gene 후보를 추천해 드립니다.
            </div>
            
            <!-- Analysis Summary Container -->
            <div class="analysis-summary">
                <!-- Overall Pathogen Summary Section -->
                <section class="summary-section">
                    <header class="section-header">
                        전체 pathogen의 타겟 유전자 종합요약
                    </header>
                    <table class="data-table">
                        <thead>
                            <tr class="data-table__row">
                                <th class="data-table__header data-table__cell">Pathogen</th>
                                <th class="data-table__header data-table__cell">Gene or Region name (최우선 or 우선)</th>
                                <th class="data-table__header data-table__cell">Note</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="data-table__row">
                                <td class="data-table__cell">MPOX</td>
                                <td class="data-table__cell">F3L, B6R, C19L</td>
                                <td class="data-table__cell">DRS: Good, mutation: low</td>
                            </tr>
                            <tr class="data-table__row">
                                <td class="data-table__cell">InfA</td>
                                <td class="data-table__cell">M, seg8, E</td>
                                <td class="data-table__cell">DRS: Good, mutation: low</td>
                            </tr>
                            <tr class="data-table__row">
                                <td class="data-table__cell">AdV</td>
                                <td class="data-table__cell">E, M,</td>
                                <td class="data-table__cell">DRS: Normal, mutation: low</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="table-note">
                        <div class="table-note-content">
                            * DRS: Design region search, 디자인 가능 지역<br>
                            * Mutation : 변이 발생률
                        </div>
                    </div>
                </section>
                
                <!-- Pathogen-specific Summary Section -->
                <section>
                    <header class="section-header">
                        Pathogen별 타겟 유전자 종합요약
                    </header>
                    
                    <div class="pathogen-selector">
                        <div class="selector-form">
                            <div class="form-field">
                                <label class="form-field__label">Pathogen name</label>
                                <div class="form-field__input">
                                    <select class="pathogen-select" id="pathogenSelect">
                                        <option value="monkeypox">Monkeypox virus</option>
                                        <option value="influenza">Influenza A virus</option>
                                        <option value="adenovirus">Adenovirus</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- 새로 추가된 순위 선택 필드 -->
                            <div class="form-field">
                                <label class="form-field__label">Gene</label>
                                <div class="form-field__input">
                                    <select class="pathogen-select" id="rankSelect" disabled>
                                        <option value="">유전자를 선택하세요</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-field">
                                <label class="form-field__label">Country</label>
                                <div class="form-field__input field-value--highlight" id="countryDisplay">all</div>
                            </div>
                            
                            <div class="form-field">
                                <label class="form-field__label">Host</label>
                                <div class="form-field__input field-value--highlight" id="hostDisplay">Human</div>
                            </div>
                            
                            <div class="form-field">
                                <label class="form-field__label">Related Disease</label>
                                <div class="form-field__input field-value--highlight" id="diseaseDisplay">Monkeypox virus infection</div>
                            </div>
                        </div>
                        
                        <aside class="info-panel" id="infoPanel">
                            <div class="info-item">
                                <span class="info-item__label">Taxonomy name:</span>
                                <span class="info-item__value" id="taxonomyName">Monkeypox</span>
                            </div>
                            <div class="info-item">
                                <span class="info-item__label">Taxonomy ID:</span>
                                <span class="info-item__value" id="taxonomyId">10244</span>
                            </div>
                            <div class="info-item">
                                <span class="info-item__label">Rank:</span>
                                <span class="info-item__value" id="rank">no rank</span>
                            </div>
                            <div class="info-item">
                                <span class="info-item__label">Synonym:</span>
                                <span class="info-item__value" id="synonym">MPXV, MPOX</span>
                            </div>
                            <div class="info-item">
                                <span class="info-item__label">Total Sequence:</span>
                                <span class="info-item__value" id="totalSequence">10,609</span>
                            </div>
                        </aside>
                    </div>
                </section>
            </div>
        </div>
    </header>

    <!-- Main Content Container -->
    <main class="main-content">
        <div class="content-container">
            <div class="markdown-content" id="markdownContent"></div>
        </div>
    </main>

    <script>
        // Pathogen Data Configuration - 순위별 구조로 변경
        const PATHOGEN_DATA = {
            monkeypox: {
                country: "all",
                host: "Human",
                disease: "Monkeypox virus infection",
                taxonomyName: "Monkeypox",
                taxonomyId: "10244",
                rank: "no rank",
                synonym: "MPXV, MPOX",
                totalSequence: "10,609",
                ranks: {
                    '1-5': {
                        label: '1위 F3L',
                        markdownContent: `
# Monkeypox Virus Analysis 1위 F3L

## 전체 요약

**Country** : all<br />
**Host** : Human<br />
**Related Disease** : Monkeypox virus infection

### 1위: F3L Gene
- **기능**: 면역 회피 관련 단백질
- **보존도**: 매우 높음 (99.8%)
- **검출 민감도**: 높음


## 추천 사항

....
`
                    },
                    '6-10': {
                        label: '2위 B6R Gene',
                        markdownContent: `
# Monkeypox Virus Analysis 2위 B6R Gene

### 2위: B6R Gene  
- **기능**: 바이러스 복제 관련
- **보존도**: 높음 (99.5%)
- **검출 민감도**: 높음

## 참고사항

...
`
                    },
                    '11-15': {
                        label: '3위 C19L',
                        markdownContent: `
# Monkeypox Virus Analysis 3위 C19L


### 3위: C19L Gene
- **기능**: 바이러스 증식 관련
- **보존도**: 높음 (99.2%)
- **검출 민감도**: 중상


## 참고사항

...
`
                    }
                }
            },
            influenza: {
                country: "-",
                host: "-",
                disease: "Influenza",
                taxonomyName: "Influenza A virus",
                taxonomyId: "-",
                rank: "no rank",
                synonym: "-",
                totalSequence: "-",
                ranks: {
                    '1-5': {
                        label: '1위 A29L',
                        markdownContent: `
# Influenza A virus Gene Marker Candidates Analysis 1위 A29L

## 조사 개요

Influenza A virus를 Real-time PCR 기반으로 진단하기 위해 적합한 타겟 유전자를 AI 분석을 통해 선별하여 추천드립니다.

### 1위: A29L Gene
- **기능**: 바이러스 외막 단백질
- **보존도**: 중상 (98.5%)
- **검출 민감도**: 중상

`
                    },
                    '6-10': {
                        label: '2위 H3L',
                        markdownContent: `
# Influenza A virus Gene Marker Candidates 2위 H3L


### 2위: H3L Gene
- **기능**: DNA 복제 효소
- **보존도**: 중상 (98.0%)
- **검출 민감도**: 중

`
                    }
                }
            },
            adenovirus: {
                country: "-",
                host: "-",
                disease: "Adenovirus infection",
                taxonomyName: "Adenovirus",
                taxonomyId: "10508",
                rank: "genus",
                synonym: "AdV",
                totalSequence: "8,932",
                ranks: {
                    '1-5': {
                        label: '1위 B5R',
                        markdownContent: `
# Adenovirus Analysis 1위 B5R

### 1위: B5R Gene
- **기능**: 보체 결합 단백질
- **보존도**: 중하 (95.0%)
- **검출 민감도**: 낮음

`
                    },
                    '6-10': {
                        label: '2위 M1R',
                        markdownContent: `
# Adenovirus Analysis 2위 M1R


### 2위: M1R Gene
- **기능**: 바이러스 조립
- **보존도**: 낮음 (94.5%)
- **검출 민감도**: 낮음

...

`
                    }
                }
            }
        };

        // DOM Element References
        const pathogenSelect = document.getElementById('pathogenSelect');
        const rankSelect = document.getElementById('rankSelect');
        const countryDisplay = document.getElementById('countryDisplay');
        const hostDisplay = document.getElementById('hostDisplay');
        const diseaseDisplay = document.getElementById('diseaseDisplay');
        const taxonomyName = document.getElementById('taxonomyName');
        const taxonomyId = document.getElementById('taxonomyId');
        const rank = document.getElementById('rank');
        const synonym = document.getElementById('synonym');
        const totalSequence = document.getElementById('totalSequence');
        const markdownContent = document.getElementById('markdownContent');

        // 현재 선택된 pathogen 추적
        let currentPathogen = null;

        /**
         * 순위 셀렉트박스 옵션 업데이트
         * @param {string} pathogenKey - Pathogen 키
         */
        function updateRankOptions(pathogenKey) {
            const data = PATHOGEN_DATA[pathogenKey];
            
            // 기존 옵션 초기화
            rankSelect.innerHTML = '<option value="">유전자를 선택하세요</option>';
            
            if (data && data.ranks) {
                // 순위 옵션 추가
                Object.keys(data.ranks).forEach(rankKey => {
                    const option = document.createElement('option');
                    option.value = rankKey;
                    option.textContent = data.ranks[rankKey].label;
                    rankSelect.appendChild(option);
                });
                
                // 셀렉트박스 활성화
                rankSelect.disabled = false;
                
                // 첫 번째 순위 자동 선택 및 렌더링
                const firstRank = Object.keys(data.ranks)[0];
                rankSelect.value = firstRank;
                updateMarkdownByRank(pathogenKey, firstRank);
            } else {
                // 순위 데이터가 없으면 비활성화
                rankSelect.disabled = true;
                markdownContent.innerHTML = '<div class="loading-state">순위별 데이터가 없습니다.</div>';
            }
        }

        /**
         * 선택된 순위에 해당하는 마크다운 렌더링
         * @param {string} pathogenKey - Pathogen 키
         * @param {string} rankKey - 순위 키 (예: '1-5', '6-10')
         */
        function updateMarkdownByRank(pathogenKey, rankKey) {
            const data = PATHOGEN_DATA[pathogenKey];
            
            if (data && data.ranks && data.ranks[rankKey]) {
                renderMarkdownContent(data.ranks[rankKey].markdownContent);
            } else {
                markdownContent.innerHTML = '<div class="loading-state">해당 순위의 데이터를 찾을 수 없습니다.</div>';
            }
        }

        /**
         * Pathogen 정보 업데이트 (수정됨)
         * @param {string} pathogenKey - Pathogen 키
         */
        function updatePathogenInfo(pathogenKey) {
            const data = PATHOGEN_DATA[pathogenKey];
            if (!data) {
                console.error(`Pathogen data not found: ${pathogenKey}`);
                return;
            }

            // 현재 pathogen 저장
            currentPathogen = pathogenKey;

            // 폼 필드 업데이트
            countryDisplay.textContent = data.country;
            hostDisplay.textContent = data.host;
            diseaseDisplay.textContent = data.disease;
            
            // 정보 패널 업데이트
            taxonomyName.textContent = data.taxonomyName;
            taxonomyId.textContent = data.taxonomyId;
            rank.textContent = data.rank;
            synonym.textContent = data.synonym;
            totalSequence.textContent = data.totalSequence;
            
            // 순위 옵션 업데이트 (새로 추가)
            updateRankOptions(pathogenKey);
        }

        /**
         * 마크다운을 HTML로 렌더링
         * @param {string} markdown - 마크다운 문자열
         */
        function renderMarkdownContent(markdown) {
            try {
                const html = marked.parse(markdown);
                markdownContent.innerHTML = html;
                
                // 테이블 반응형 래퍼 추가
                wrapTablesForResponsive();
            } catch (error) {
                console.error('Error rendering markdown:', error);
                markdownContent.innerHTML = '<div class="loading-state">콘텐츠 로딩 중 오류가 발생했습니다.</div>';
            }
        }

        /**
         * 테이블을 반응형 래퍼로 감싸기
         */
        function wrapTablesForResponsive() {
            const tables = markdownContent.querySelectorAll('table');
            tables.forEach(table => {
                if (!table.parentElement.classList.contains('table-wrapper')) {
                    const wrapper = document.createElement('div');
                    wrapper.className = 'table-wrapper';
                    table.parentNode.insertBefore(wrapper, table);
                    wrapper.appendChild(table);
                }
            });
        }

        /**
         * 애플리케이션 초기화
         */
        function initializeApp() {
            // Pathogen 선택 이벤트 리스너
            pathogenSelect.addEventListener('change', (event) => {
                const selectedPathogen = event.target.value;
                updatePathogenInfo(selectedPathogen);
            });
            
            // 순위 선택 이벤트 리스너 (새로 추가)
            rankSelect.addEventListener('change', (event) => {
                const selectedRank = event.target.value;
                if (currentPathogen && selectedRank) {
                    updateMarkdownByRank(currentPathogen, selectedRank);
                }
            });
            
            // 초기 pathogen 데이터 로드
            updatePathogenInfo('monkeypox');
        }

        // DOM 준비 완료 시 앱 초기화
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>
